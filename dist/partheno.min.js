!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=3)}([function(t,e){t.exports=function(t){return t&&t.__esModule?t:{default:t}}},function(t,e){function i(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&i(t.prototype,e),r&&i(t,r),t}},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e,i){"use strict";var r=i(0);Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(i(2)),a=r(i(1)),s=function(){function t(e){(0,n.default)(this,t),this.uniqueId=e.uniqueId,this.patterns=e.patterns,this.height=e.height,this.width=e.width,this.chamfer=e.chamferWidth,this.chamferRt=e.chamferRt,this.chamferRb=e.chamferRb,this.chamferLt=e.chamferLt,this.chamferLb=e.chamferLb,this.roundBorder=e.roundBorderWidth,this.roundBorderRt=e.roundBorderRt,this.roundBorderRb=e.roundBorderRb,this.roundBorderLt=e.roundBorderLt,this.roundBorderLb=e.roundBorderLb,this.enableTriangles=e.enableTriangles,this.numberOfPairOfTriangles=e.numberOfpairs,this.showStrokes=e.showStrokes,this.columnsPerWidth=e.columnsPerWidth,this.canDownload=e.canDownload,this.backgroundPattern=e.background,e.evenPattern?this.triangleEvenPattern=e.evenPattern:this.triangleEvenPattern=this._getRandomPattern("triangles"),e.oddPattern?this.triangleOddPattern=e.oddPattern:this.triangleOddPattern=this._getRandomPattern("triangles"),this.images=[],this.wrapper=null,this._init()}return(0,a.default)(t,[{key:"_init",value:function(){this._createCanvasWrapper("canva-"+this.uniqueId,"zone-"+this.uniqueId),this.zone="background",this._initPatterns(),this.zone="triangles",this._initPatterns()}},{key:"_getRandomPattern",value:function(t){var e,i;return void 0!==this.patterns[t]&&(i=Math.floor(Math.random()*this.patterns[t].length),e=this._getFullDecodedPath(this.patterns[t][i].data)),e}},{key:"_hasChamfer",value:function(){return this.chamferRt||this.chamferRb||this.chamferLt||this.chamferLb}},{key:"_hasRoundBorder",value:function(){return this._roundBorderRt||this._roundBorderRb||this._roundBorderLt||this._roundBorderLb}},{key:"_getFullDecodedPath",value:function(t){return btoa(this.patterns.path+t)}},{key:"_encode",value:function(t){return atob(t)}},{key:"_findPattern",value:function(t){var e;return this.patterns.background.map(function(i){i.title===t&&(e=i.data)}),e}},{key:"_setBackgroundPatterns",value:function(t){if(this._hasChamfer())this._drawChamferedRect(0,0,this.el_canvas.width,this.el_canvas.height,this.chamfer,this.chamferRt,this.chamferRb,this.chamferLt,this.chamferLb),Array.isArray(t)?this._buidMirroredPattern(t):this._applyStyle(this.images[t]),this.el_ctx.fill();else{var e=this._findPattern(t);Array.isArray(e)?(this._buidMirroredPattern(e),this.el_ctx.fill()):(this._applyStyle(this.images[this._getFullDecodedPath(e)]),this.el_ctx.fillRect(0,0,this.el_canvas.width,this.el_canvas.height))}}},{key:"_buidMirroredPattern",value:function(t){var e=this;this.el_ctx.strokeRect(0,0,this.el_canvas.width,this.el_canvas.height);var i=parseFloat(this.el_canvas.width/2),r=this.width,n=this.height;t.forEach(function(t,a){var s=e.images[e._getFullDecodedPath(t)];s&&(0===a&&e.el_ctx.drawImage(s,0,0,r,n),1===a&&e.el_ctx.drawImage(s,i,0,r,n),2===a&&e.el_ctx.drawImage(s,0,200,r,n),3===a&&e.el_ctx.drawImage(s,i,200,r,n))})}},{key:"_drawRoundedRect",value:function(t,e,i,r,n,a,s,h,o){var l=t+i,c=e+r;this.el_ctx.beginPath(),this.el_ctx.strokeStyle="green",this.el_ctx.lineWidth="2",a?(s?this.el_ctx.moveTo(t,e):this.el_ctx.moveTo(t+n,e),this.el_ctx.lineTo(l-n,e),this.el_ctx.quadraticCurveTo(l,e,l,e+n)):(o?this.el_ctx.moveTo(t+n,e):this.el_ctx.moveTo(t,e),this.el_ctx.lineTo(l,e)),h?(this.el_ctx.lineTo(l,e+r-n),this.el_ctx.quadraticCurveTo(l,c,l-n,c)):this.el_ctx.lineTo(l,e+r),s?(this.el_ctx.lineTo(t+n,c),this.el_ctx.quadraticCurveTo(t,c,t,c-n)):this.el_ctx.lineTo(t,c),o?(this.el_ctx.lineTo(t,e+n),this.el_ctx.quadraticCurveTo(t,e,t+n,e)):this.el_ctx.lineTo(t,e),this.el_ctx.stroke()}},{key:"_drawChamferedRect",value:function(t,e,i,r,n,a,s,h,o){var l=t+i,c=e+r;this.el_ctx.moveTo(t+n,e),a?(this.el_ctx.lineTo(l-n,e),this.el_ctx.lineTo(l,e+n)):(this.el_ctx.lineTo(l-n,e),this.el_ctx.lineTo(l,e)),o?(this.el_ctx.lineTo(l,e+r-n),this.el_ctx.lineTo(l-n,c)):this.el_ctx.lineTo(l,e+r),s?(this.el_ctx.lineTo(t+n,c),this.el_ctx.lineTo(t,c-n)):this.el_ctx.lineTo(t,c),h?(this.el_ctx.lineTo(t,e+n),this.el_ctx.lineTo(t+n,e)):this.el_ctx.lineTo(t,e)}},{key:"_createCanvasWrapper",value:function(t,e){var i=this,r=document.createElement("div");r.id=e,r.className="zone";var n=document.createElement("canvas");n.id=t,n.className="zone--canvas",n.width=this.width,n.height=this.height,n.showStrokes=this.showStrokes,n.chamfer=this.chamfer,n.chamferRt=this.chamferRt,n.chamferRb=this.chamferRb,n.chamferLt=this.chamferLt,n.chamferLb=this.chamferLb,n.roundBorder=this._roundBorder,n.roundBorderRt=this.roundBorderRt,n.roundBorderRb=this.roundBorderRb,n.roundBorderLt=this.roundBorderLt,n.roundBorderLb=this.roundBorderLb,n.backgroundPatternTriangleEven=this.triangleEvenPattern,n.backgroundPatternTriangleOdd=this.triangleOddPattern,n.innerHTML="Votre navigateur ne supporte pas canvas.<br>Essayez avec Firefox, Safari, Chrome ou Opera.",setTimeout(function(){i.clearCanvasLayers(),r&&r.appendChild(n)}),this.wrapper=r,this.el_canvas=n,this.el_ctx=this.el_canvas.getContext("2d"),setTimeout(function(){i._canDownload()&&i._createDownloadLink("link-"+i.uniqueId,"zone-"+i.uniqueId),i._createDetailLink("modal-"+i.uniqueId,"zone-"+i.uniqueId)})}},{key:"clearCanvasLayers",value:function(){if(this.el_canvas){var t=this.el_canvas.clientWidth,e=this.el_canvas.clientHeight;this.el_ctx.clearRect(0,0,t,e)}}},{key:"getFiltered",value:function(){for(var t=[],e=0;e<this.patterns[this.zone].length;e++){var i=this.patterns[this.zone][e];i.data&&t.push(i.data)}return t}},{key:"getFilteredPatternsObjects",value:function(t){var e={};return this.patterns[t].filter(function(t){return t.data&&(e[t.title]=t.title),!0}),e}},{key:"_initPatterns",value:function(){var t=this,e=this.getFiltered();if(e&&Array.isArray(e)){var i=e.length;e.forEach(function(e){if(Array.isArray(e))e.forEach(function(e){var r=new Image,n=t._getFullDecodedPath(e);r.onload=function(){t.images[n]=r,t.repeatBackgroundWidth=t.width/r.width,t.repeatBackgroundHeight=t.height/r.height},r.src=t._encode(n),0===i&&t._triggeredOnPattersLoaded(t._encode(n))}),--i;else{var r=new Image,n=t._getFullDecodedPath(e);r.onload=function(){t.images[n]=t.el_ctx.createPattern(r,"repeat"),0===--i&&t._triggeredOnPatternsLoaded(t._encode(n))},r.src=t._encode(n)}})}}},{key:"_createDetailLink",value:function(t,e){var i=document.getElementById(e),r=document.createElement("button");r.type="button",r.className="btn btn-primary btn-sm",r.innerText="Modify",r.addEventListener("click",function(){$("#"+t).modal("toggle")},!1),i&&i.insertBefore(r,i.firstChild)}},{key:"_createDownloadLink",value:function(t,e){var i=this,r=document.getElementById(e),n=document.createElement("a");n.innerHTML="Download",n.classList="btn btn-dark btn-sm",n.id=t,n.href="#",n.role="button",n.addEventListener("click",function(){n.href=i.el_canvas.toDataURL("image/jpeg"),n.download="bookmark.jpg"},!1),r&&r.insertBefore(n,r.firstChild)}},{key:"_createParamDebugZone",value:function(){var t=document.createElement("textarea");t.cols=80,t.rows=10,t.readOnly=!0,t.innerHTML=JSON.stringify(this)}},{key:"_drawBackgroundPattern",value:function(){this._setBackgroundPatterns(this.backgroundPattern)}},{key:"_applyStyle",value:function(t){this.el_ctx.fillStyle=t}},{key:"_drawSingleTriangle",value:function(t){var e,i=this;this.patterns.triangles.map(function(r){r.title===(!0===t?i.el_canvas.backgroundPatternTriangleEven:i.el_canvas.backgroundPatternTriangleOdd)&&(e=r.data)}),this._applyStyle(this.images[this._getFullDecodedPath(e)]),t?(this.el_ctx.lineTo(this._column_width+this._offset,this._first_coef),this.el_ctx.lineTo(this._offset,this._first_coef)):(this.el_ctx.lineTo(this._column_width+this._offset,this._second_coef),this.el_ctx.lineTo(this._offset,this._second_coef))}},{key:"_drawTriangles",value:function(){var t;this._hasChamfer()&&this.el_ctx.clip(),this._column_width=this.el_canvas.width/this.columnsPerWidth;for(var e=this._column_width/2,i=1;i<=this.numberOfPairOfTriangles;i++)for(var r=0;r<this.columnsPerWidth;r++){this.el_ctx.lineWidth=1,this._offset=r*this._column_width,t=this.el_canvas.height/(2*this.numberOfPairOfTriangles),this._first_coef=2*(t*i-t),this._second_coef=this._first_coef+2*t,this._third_coef=(this._second_coef-t)/i*i;for(var n=1;n<=2;n++)this.el_ctx.beginPath(),this.el_ctx.moveTo(e+this._offset,this._third_coef),n%2==1?this._drawSingleTriangle(!0):this._drawSingleTriangle(!1),this.el_ctx.closePath(),this._drawStrokes(),this.el_ctx.fill()}this._hasChamfer()&&this.el_ctx.restore()}},{key:"_canDownload",value:function(){return!0===this.canDownload}},{key:"_canDrawTriangle",value:function(){return!0===this.enableTriangles}},{key:"_canDisplayStrokes",value:function(){return!0===this.el_canvas.showStrokes}},{key:"_drawStrokes",value:function(){this._canDisplayStrokes()&&(this.el_ctx.strokeStyle="#FF0000",this.el_ctx.stroke())}},{key:"render",value:function(){var t=this;setTimeout(function(){t._drawBackgroundPattern(),t._canDrawTriangle()&&t._drawTriangles()},100)}},{key:"_triggeredOnPatternsLoaded",value:function(t){this.clearCanvasLayers(),this.render()}}],[{key:"Builder",get:function(){return function(){function e(t){(0,n.default)(this,e),this.uniqueId=t}return(0,a.default)(e,[{key:"sized",value:function(t,e){return this.height=t,this.width=e,this}},{key:"columnsPerWidth",value:function(t){return this.columnsPerWidth=t,this}},{key:"downloadable",value:function(t){return this.canDownload=t,this}},{key:"withStrokes",value:function(t){return this.showStrokes=t,this}},{key:"withBackground",value:function(t){return this.background=t,this}},{key:"withNumberOfPairs",value:function(t){return this.numberOfpairs=t,this}},{key:"withTriangles",value:function(t){return this.enableTriangles=t,this}},{key:"withPatterns",value:function(t,e,i){return this.patterns=t,this.evenPattern=e,this.oddPattern=i,this}},{key:"withChamfers",value:function(t,e,i,r,n){return this.chamferWidth=t,this.chamferRt=e,this.chamferRb=i,this.chamferLt=r,this.chamferLb=n,this}},{key:"withRoundBorder",value:function(t,e,i,r,n){return this.roundBorderWidth=t,this.roundBorderRt=e,this.roundBorderRb=i,this.roundBorderLt=r,this.roundBorderLb=n,this}},{key:"build",value:function(){return new t(this)}}]),e}()}}]),t}();e.default=s}]);
//# sourceMappingURL=partheno.min.js.map