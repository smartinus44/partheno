!function(t){var e={};function i(n){if(e[n])return e[n].exports;var a=e[n]={i:n,l:!1,exports:{}};return t[n].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=function(){function t(e,i,n,a,r,s,h,l,c,o,u,f,d,_,v,m){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.uniqueId=e,this.images=[],this.numberOfPairOfTriangles=3,this.patterns=u,this.height=i,this.width=n,this.chamferRt=d,this.chamferRb=_,this.chamferLt=v,this.chamferLb=m,this.backgroundPattern=a||this.getRandomPattern("background"),this.triangleEvenPattern=s||this.getRandomPattern("triangles"),this.triangleOddPattern=h||this.getRandomPattern("triangles"),this.numberOfPairOfTriangles=r,this.showStrokes=l,this.columnsPerWidth=c,this.canDownload=o,this.chamfer=f,this.el_canvas=this.createCanvas("canva-"+e,"zone-"+e),!0===this.canDownload&&this.createDownloadLink(e),this.el_ctx=this.el_canvas.getContext("2d"),this.initPatterns("triangles"),this.initPatterns("background")}var e,i,a;return e=t,(i=[{key:"getRandomPattern",value:function(t){console.log(this.uniqueId),console.log(this.patterns);var e=Math.floor(Math.random()*this.patterns[t].length);return this.patterns.path+this.patterns[t][e]}},{key:"setBackgroundPattern",value:function(t){this.el_ctx.fillStyle=this.images[t],this.chamfer>0?(this.chamferedRect(0,0,this.el_canvas.width,this.el_canvas.height,this.chamfer,this.chamferRt,this.chamferRb,this.chamferLt,this.chamferLb),this.el_ctx.fill()):this.el_ctx.fillRect(0,0,this.el_canvas.width,this.el_canvas.height)}},{key:"roundRect",value:function(t,e,i,n,a,r,s,h,l){var c=t+i,o=e+n;this.el_ctx.beginPath(),this.el_ctx.strokeStyle="green",this.el_ctx.lineWidth="2",r?(s?this.el_ctx.moveTo(t,e):this.el_ctx.moveTo(t+a,e),this.el_ctx.lineTo(c-a,e),this.el_ctx.quadraticCurveTo(c,e,c,e+a)):(l?this.el_ctx.moveTo(t+a,e):this.el_ctx.moveTo(t,e),this.el_ctx.lineTo(c,e)),h?(this.el_ctx.lineTo(c,e+n-a),this.el_ctx.quadraticCurveTo(c,o,c-a,o)):this.el_ctx.lineTo(c,e+n),s?(this.el_ctx.lineTo(t+a,o),this.el_ctx.quadraticCurveTo(t,o,t,o-a)):this.el_ctx.lineTo(t,o),l?(this.el_ctx.lineTo(t,e+a),this.el_ctx.quadraticCurveTo(t,e,t+a,e)):this.el_ctx.lineTo(t,e),this.el_ctx.stroke()}},{key:"chamferedRect",value:function(t,e,i,n,a,r,s,h,l){var c=t+i,o=e+n;this.el_ctx.moveTo(t+a,e),r?(this.el_ctx.lineTo(c-a,e),this.el_ctx.lineTo(c,e+a)):(this.el_ctx.lineTo(c-a,e),this.el_ctx.lineTo(c,e)),l?(this.el_ctx.lineTo(c,e+n-a),this.el_ctx.lineTo(c-a,o)):this.el_ctx.lineTo(c,e+n),s?(this.el_ctx.lineTo(t+a,o),this.el_ctx.lineTo(t,o-a)):this.el_ctx.lineTo(t,o),h?(this.el_ctx.lineTo(t,e+a),this.el_ctx.lineTo(t+a,e)):this.el_ctx.lineTo(t,e)}},{key:"createCanvas",value:function(t,e){var i=document.createElement("canvas");i.innerHTML="Votre navigateur ne supporte pas canvas.<br>Essayez avec Firefox, Safari, Chrome ou Opera.";var n=document.getElementById(e);return i.id=t,i.width=this.width,i.height=this.height,i.showStrokes=this.showStrokes,i.chamfer=this.chamfer,i.chamferRt=this.chamferRt,i.chamferRb=this.chamferRb,i.chamferLt=this.chamferLt,i.chamferLb=this.chamferLb,i.backgroundPatternTriangleEven=this.triangleEvenPattern,i.backgroundPatternTriangleOdd=this.triangleOddPattern,n.appendChild(i),this.clearCanvasLayers(),i}},{key:"clearCanvasLayers",value:function(){if(this.el_canvas){var t=this.el_canvas.clientWidth,e=this.el_canvas.clientHeight;this.el_ctx.clearRect(0,0,t,e)}}},{key:"initPatterns",value:function(t){var e=this.patterns[t].length,i=this,n=this.patterns.path;this.patterns[t].forEach(function(t){if(Array.isArray(t));else{var a=encodeURI(n+t),r=new Image;r.onload=function(){i.images[a]=i.el_ctx.createPattern(r,"repeat"),0===--e&&i._onPatternsLoaded()},r.src=a}})}},{key:"createDownloadLink",value:function(t){var e=document.getElementById("zone-"+t),i=document.createElement("a"),n=this;i.innerHTML="Download the picture",i.className="btn btn-dark",i.href="#",i.role="button",i.addEventListener("click",function(){i.href=n.el_canvas.toDataURL(),i.download="bookmark.jpg"},!1),e.insertBefore(document.createElement("br"),e.firstChild),e.insertBefore(document.createElement("br"),e.firstChild);var a=document.createElement("textarea");a.cols=80,a.rows=10,a.readOnly=!0,a.innerHTML=JSON.stringify(n),e.insertBefore(i,e.firstChild)}},{key:"drawTriangles",value:function(){var t;this.el_canvas.chamfer>0&&this.el_ctx.clip();for(var e=this.el_canvas.width/this.columnsPerWidth,i=e/2,n=1;n<=this.numberOfPairOfTriangles;n++)for(var a=0;a<this.columnsPerWidth;a++){t=this.el_canvas.height/(2*this.numberOfPairOfTriangles),this.el_ctx.lineWidth=1;for(var r=a*e,s=2*(t*n-t),h=s+2*t,l=(h-t)/n*n,c=1;c<=2;c++)this.el_ctx.beginPath(),this.el_ctx.moveTo(i+r,l),c%2==1?(this.el_ctx.fillStyle=this.images[this.el_canvas.backgroundPatternTriangleEven],this.el_ctx.lineTo(e+r,s),this.el_ctx.lineTo(r,s)):(this.el_ctx.fillStyle=this.images[this.el_canvas.backgroundPatternTriangleOdd],this.el_ctx.lineTo(e+r,h),this.el_ctx.lineTo(r,h)),this.el_ctx.closePath(),!0===this.el_canvas.showStrokes&&(this.el_ctx.strokeStyle="#FF0000",this.el_ctx.stroke()),this.el_ctx.fill()}this.el_canvas.chamfer>0&&this.el_ctx.restore()}},{key:"_onPatternsLoaded",value:function(){this.clearCanvasLayers(),console.dir(this.backgroundPattern),this.setBackgroundPattern(this.backgroundPattern),this.drawTriangles()}}])&&n(e.prototype,i),a&&n(e,a),t}();e.default=a}]);